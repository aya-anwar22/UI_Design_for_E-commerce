<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Products - Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <style>
    :root {
      --sidebar-width: 250px;
      --sidebar-bg: #2c3e50;
      --sidebar-color: #ecf0f1;
      --sidebar-active-bg: #3498db;
      --content-bg: #f5f6fa;
      --card-bg: #ffffff;
      --required-color: #e74c3c;
      --table-header-bg: #f8f9fa;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: var(--content-bg);
      overflow-x: hidden;
    }

    .sidebar {
            background-color: white;
            height: 100vh;
            position: fixed;
            width: 250px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            padding-top: 20px;
        }

        .sidebar-brand {
            padding: 1rem 1.5rem;
            font-weight: bold;
            font-size: 1.2rem;
            color: var(--primary-color);
            display: flex;
            align-items: center;
        }

        .sidebar-brand i {
            margin-right: 10px;
            font-size: 1.5rem;
        }

        .sidebar-menu {
            margin-top: 2rem;
        }

        .sidebar-menu-item {
            padding: 0.8rem 1.5rem;
            margin: 0.2rem 0;
            color: #6c757d;
            text-decoration: none;
            display: flex;
            align-items: center;
            border-radius: 0.25rem;
            transition: all 0.3s;
        }

        .sidebar-menu-item:hover {
            background-color: #f0f2f5;
            color: var(--primary-color);
        }

        .sidebar-menu-item.active {
            background-color: rgba(67, 97, 238, 0.1);
            color: var(--primary-color);
            font-weight: 500;
        }

        .sidebar-menu-item i {
            margin-right: 10px;
            font-size: 1.1rem;
        }

    .content {
      margin-left: var(--sidebar-width);
      padding: 1.5rem;
      min-height: 100vh;
    }

    .header {
      background-color: var(--card-bg);
      padding: 1rem;
      border-radius: 0.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    }

    .card {
      border: none;
      border-radius: 0.5rem;
      box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
      margin-bottom: 1.5rem;
    }

    .card-header {
      background-color: var(--card-bg);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      padding: 1rem 1.5rem;
      border-radius: 0.5rem 0.5rem 0 0 !important;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .card-title {
      margin-bottom: 0;
      font-weight: 600;
    }

    .card-body {
      padding: 1.5rem;
    }

    .form-label {
      font-weight: 500;
    }

    .required {
      color: var(--required-color);
    }

    .upload-area {
      border: 2px dashed #dee2e6;
      border-radius: 0.5rem;
      padding: 2rem;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
    }

    .upload-area:hover {
      border-color: #3498db;
      background-color: rgba(52, 152, 219, 0.05);
    }

    .upload-content i {
      font-size: 2.5rem;
      color: #7f8c8d;
      margin-bottom: 0.5rem;
    }

    .upload-content p {
      margin-bottom: 0.25rem;
    }

    .upload-content small {
      color: #7f8c8d;
    }

    .preview-container {
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
    }

    .image-preview {
      position: relative;
      width: 100px;
      height: 100px;
      border-radius: 0.25rem;
      overflow: hidden;
    }

    .image-preview img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .btn-remove {
      position: absolute;
      top: 0.25rem;
      right: 0.25rem;
      width: 1.5rem;
      height: 1.5rem;
      background-color: rgba(231, 76, 60, 0.8);
      color: white;
      border: none;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0;
      cursor: pointer;
    }

    .form-actions {
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      padding: 1rem 0;
    }

    footer {
      background-color: var(--sidebar-bg);
      color: var(--sidebar-color);
      padding: 1rem;
      margin-left: var(--sidebar-width);
    }

    /* Products table styles */
    .products-table {
      width: 100%;
      background-color: var(--card-bg);
      border-radius: 0.5rem;
      overflow: hidden;
      box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
    }

    .products-table th {
      background-color: var(--table-header-bg);
      padding: 1rem;
      text-align: left;
      font-weight: 600;
    }

    .products-table td {
      padding: 1rem;
      border-top: 1px solid #dee2e6;
      vertical-align: middle;
    }

    .products-table tr:hover {
      background-color: rgba(0, 0, 0, 0.02);
    }

    .product-image {
      width: 60px;
      height: 60px;
      border-radius: 0.25rem;
      object-fit: cover;
    }

    .badge {
      font-weight: 500;
      padding: 0.35em 0.65em;
    }

    .badge-in-stock {
      background-color: #d1e7dd;
      color: #0f5132;
    }

    .badge-low-stock {
      background-color: #fff3cd;
      color: #664d03;
    }

    .badge-out-of-stock {
      background-color: #f8d7da;
      color: #842029;
    }

    .action-btn {
      padding: 0.25rem 0.5rem;
      font-size: 0.875rem;
    }

    .view-more {
      color: #0d6efd;
      cursor: pointer;
    }

    .tab-content {
      padding: 0;
      background: transparent;
      border: none;
    }

    .nav-tabs .nav-link {
      border: none;
      color: #495057;
      font-weight: 500;
      padding: 0.75rem 1.25rem;
    }

    .nav-tabs .nav-link.active {
      color: #0d6efd;
      border-bottom: 2px solid #0d6efd;
      background: transparent;
    }

    .nav-tabs {
      border-bottom: 1px solid #dee2e6;
    }

    /* Modal styles */
    .modal-product-image {
      max-width: 100%;
      max-height: 300px;
      border-radius: 0.25rem;
    }

    .product-details-list {
      list-style: none;
      padding: 0;
    }

    .product-details-list li {
      padding: 0.5rem 0;
      border-bottom: 1px solid #f0f0f0;
    }

    .product-details-list strong {
      display: inline-block;
      width: 150px;
    }

    @media (max-width: 768px) {
      .sidebar {
        width: 0;
        overflow: hidden;
      }
      .content, footer {
        margin-left: 0;
      }
      
      .products-table {
        display: block;
        overflow-x: auto;
      }
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <div class="sidebar-brand">
      <i class="fas fa-store"></i>
      <span>EcomDash</span>
    </div>
    <div class="sidebar-menu">
      <a href="home.html" class="sidebar-menu-item">
        <i class="fas fa-tachometer-alt"></i>
        <span>Dashboard</span>
      </a>
      <a href="products.html" class="sidebar-menu-item active">
        <i class="fas fa-shopping-cart"></i>
        <span>Products</span>
      </a>
      <a href="user.html" class="sidebar-menu-item">
        <i class="fas fa-users"></i>
        <span>Customers</span>
      </a>
      <a href="order.html" class="sidebar-menu-item">
        <i class="fas fa-receipt"></i>
        <span>Orders</span>
      </a>
     
  
    </div>
  </div>

  <main class="content">
    <div class="header">
      <div class="d-flex justify-content-between align-items-center">
        <h4>Product Management</h4>
        <div class="search-box">
          <div class="input-group">
            <span class="input-group-text"><i class="fas fa-search"></i></span>
            <input type="search" placeholder="Search products..." class="form-control" id="searchInput" />
          </div>
        </div>
      </div>
    </div>

    <ul class="nav nav-tabs" id="productTabs" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active" id="view-tab" data-bs-toggle="tab" data-bs-target="#view-products" type="button" role="tab">View Products</button>
      </li>
      <li class="nav-item" role="presentation">
        <button class="nav-link" id="add-tab" data-bs-toggle="tab" data-bs-target="#add-product" type="button" role="tab">Add Product</button>
      </li>
    </ul>

    <div class="tab-content" id="productTabsContent">
      <!-- View Products Tab -->
      <div class="tab-pane fade show active" id="view-products" role="tabpanel">
        <div class="card">
          <div class="card-header">
            <h5 class="card-title mb-0">All Products</h5>
            <div class="d-flex align-items-center">
              <select class="form-select form-select-sm me-2" style="width: 150px;" id="filterCategory">
                <option value="">All Categories</option>
                <option>Men's Clothing</option>
                <option>Women's Clothing</option>
               
              </select>
              <select class="form-select form-select-sm" style="width: 120px;" id="filterStatus">
                <option value="">All Status</option>
                <option>In Stock</option>
                <option>Low Stock</option>
                <option>Out of Stock</option>
              </select>
            </div>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="products-table">
                <thead>
                  <tr>
                    <th>Product</th>
                    <th>Category</th>
                    <th>Brand</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="productsTableBody">
                  <!-- Products will be loaded here dynamically -->
                </tbody>
              </table>
            </div>
            
            <nav class="d-flex justify-content-between align-items-center mt-3">
              <div class="form-text">Showing <span id="showingFrom">1</span> to <span id="showingTo">10</span> of <span id="totalProducts">25</span> products</div>
              <ul class="pagination pagination-sm mb-0">
                <li class="page-item disabled">
                  <a class="page-link" href="#" tabindex="-1">Previous</a>
                </li>
                <li class="page-item active"><a class="page-link" href="#">1</a></li>
                <li class="page-item"><a class="page-link" href="#">2</a></li>
                <li class="page-item"><a class="page-link" href="#">3</a></li>
                <li class="page-item">
                  <a class="page-link" href="#">Next</a>
                </li>
              </ul>
            </nav>
          </div>
        </div>
      </div>

      <!-- Add Product Tab -->
      <div class="tab-pane fade" id="add-product" role="tabpanel">
        <form id="productForm" class="product-form">
          <div class="row">
            <div class="col-md-6">
              <div class="card mb-4">
                <div class="card-header">
                  <h5 class="card-title">Basic Information</h5>
                </div>
                <div class="card-body">
                  <div class="mb-3">
                    <label for="productName" class="form-label">Product name <span class="required">*</span></label>
                    <input type="text" class="form-control" id="productName" name="productName" placeholder="Enter product name" required />
                    <div class="form-text">Product name should be between 3-100 characters.</div>
                  </div>

                  <div class="mb-3">
                    <label for="productSlug" class="form-label">Product Slug <span class="required">*</span></label>
                    <input type="text" class="form-control" id="productSlug" name="productSlug" placeholder="product-slug" required />
                    <div class="form-text">Unique URL identifier for the product (e.g., "blue-t-shirt")</div>
                  </div>

                  <div class="mb-3">
                    <label for="subcategoryId" class="form-label">Subcategory <span class="required">*</span></label>
                    <select id="subcategoryId" name="subcategoryId" class="form-select" required>
                      <option value="">Choose subcategory</option>
                      <option value="1">T-Shirts</option>
                      <option value="2">Jeans</option>
                      <option value="3">Sneakers</option>
                    </select>
                  </div>

                  <div class="mb-3">
                    <label class="form-label">Gender <span class="required">*</span></label><br/>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="gender" id="genderMale" value="male" required />
                      <label class="form-check-label" for="genderMale">Male</label>
                    </div>
                    <div class="form-check form-check-inline">
                      <input class="form-check-input" type="radio" name="gender" id="genderFemale" value="female" />
                      <label class="form-check-label" for="genderFemale">Female</label>
                    </div>
                  </div>

                  <div class="mb-3">
                    <label for="brandId" class="form-label">Brand <span class="required">*</span></label>
                    <select id="brandId" name="brandId" class="form-select" required>
                      <option value="">Choose brand</option>
                      <option value="1">Nike</option>
                      <option value="2">Adidas</option>
                      <option value="3">Puma</option>
                    </select>
                  </div>

                  <div class="mb-3">
                    <label for="description" class="form-label">Description</label>
                    <textarea id="description" name="description" rows="3" class="form-control" placeholder="Product description"></textarea>
                  </div>
                </div>
              </div>
            </div>

            <div class="col-md-6">
              <div class="card mb-4">
                <div class="card-header">
                  <h5 class="card-title">Pricing & Inventory</h5>
                </div>
                <div class="card-body">
                  <div class="mb-3">
                    <label for="price" class="form-label">Price <span class="required">*</span></label>
                    <div class="input-group">
                      <span class="input-group-text">$</span>
                      <input type="number" step="0.01" min="0" class="form-control" id="price" name="price" placeholder="0.00" required />
                    </div>
                  </div>

                  <div class="mb-3">
                    <label for="quantity" class="form-label">Quantity <span class="required">*</span></label>
                    <input type="number" min="0" class="form-control" id="quantity" name="quantity" placeholder="0" required />
                  </div>

                  <div class="mb-3">
                    <label for="stockAlertThreshold" class="form-label">Stock Alert Threshold</label>
                    <input type="number" min="0" class="form-control" id="stockAlertThreshold" name="stockAlertThreshold" placeholder="0" />
                    <div class="form-text">Get notified when stock reaches this level</div>
                  </div>
                </div>
              </div>

              <div class="card mb-4">
                <div class="card-header">
                  <h5 class="card-title">Product Images</h5>
                </div>
                <div class="card-body">
                  <div class="mb-3">
                    <label class="form-label">Upload images <span class="required">*</span></label>
                    <div class="upload-area" id="uploadArea">
                      <div class="upload-content">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <p>Drop your images here or <span class="text-primary">click to browse</span></p>
                        <small>Supports JPG, PNG up to 5MB</small>
                      </div>
                      <input type="file" id="imageUpload" multiple accept="image/*" style="display:none" />
                    </div>
                    <div class="preview-container mt-2" id="previewContainer"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary px-4"><i class="fas fa-plus me-2"></i> Add product</button>
            <button type="button" class="btn btn-outline-secondary"><i class="fas fa-times me-2"></i> Cancel</button>
          </div>
        </form>
      </div>
    </div>
  </main>

  <!-- Product Details Modal -->
  <div class="modal fade" id="productDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Product Details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6">
              <div id="productImagesCarousel" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-inner" id="carouselInner">
                  <!-- Images will be added here -->
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#productImagesCarousel" data-bs-slide="prev">
                  <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                  <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#productImagesCarousel" data-bs-slide="next">
                  <span class="carousel-control-next-icon" aria-hidden="true"></span>
                  <span class="visually-hidden">Next</span>
                </button>
              </div>
            </div>
            <div class="col-md-6">
              <h3 id="modalProductName"></h3>
              <div class="mb-3">
                <span class="badge bg-primary me-2" id="modalProductCategory"></span>
                <span class="badge bg-secondary" id="modalProductBrand"></span>
              </div>
              
              <ul class="product-details-list">
                <li><strong>Product ID:</strong> <span id="modalProductId"></span></li>
                <li><strong>Description:</strong> <span id="modalProductDescription"></span></li>
                <li><strong>Price:</strong> $<span id="modalProductPrice"></span></li>
                <li><strong>Quantity:</strong> <span id="modalProductQuantity"></span></li>
                <li><strong>Stock Status:</strong> <span id="modalProductStatus"></span></li>
                <li><strong>Gender:</strong> <span id="modalProductGender"></span></li>
                <li><strong>Created At:</strong> <span id="modalProductCreated"></span></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary">Edit Product</button>
        </div>
      </div>
    </div>
  </div>

  <footer>
    <div class="container-fluid">
      <div class="row align-items-center">
        <div class="col-md-6 text-md-start">
          Copyright Â© 2024 EcomDash. All rights reserved.
        </div>
        <div class="col-md-6 text-md-end">
          <a href="#" class="text-white me-3">Terms</a>
          <a href="#" class="text-white me-3">Privacy</a>
          <a href="#" class="text-white">Help Center</a>
        </div>
      </div>
    </div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Image upload preview functionality
      const imageUpload = document.getElementById('imageUpload');
      const previewContainer = document.getElementById('previewContainer');
      const uploadArea = document.getElementById('uploadArea');
      const productForm = document.getElementById('productForm');
      const productsTableBody = document.getElementById('productsTableBody');
      const searchInput = document.getElementById('searchInput');
      const filterCategory = document.getElementById('filterCategory');
      const filterStatus = document.getElementById('filterStatus');
      
      // Sample product data (in a real app, this would come from API)
      let products = [
  
        {
          _id: '2',
          productName: 'Women\'s Jeans Pants',
          productSlug: 'womens-Jeans-pants',
          description: 'Stretchy and comfortable Jeans pants for women',
          brandId: '2',
          brandName: 'Adidas',
          subcategoryId: '2',
          subcategoryName: 'Jeans',
          price: 49.99,
          quantity: 8,
          gender: 'female',
          productImages: [
            'https://th.bing.com/th/id/OIP.2oWsDw8XnT0aJ5qo_QAZ5gHaGt?r=0&rs=1&pid=ImgDetMain',
            'https://th.bing.com/th/id/OIP.2oWsDw8XnT0aJ5qo_QAZ5gHaGt?r=0&rs=1&pid=ImgDetMain'
          ],
          stockAlertThreshold: 5,
          createdAt: '2023-06-20T14:15:00Z'
        },
        {
          _id: '3',
          productName: 'T-Shirt',
          productSlug: 't-shirt',
          description: 'Basic cotton t-shirt for everyday wear',
          brandId: '3',
          brandName: 'Puma',
          subcategoryId: '1',
          subcategoryName: 'T-Shirts',
          price: 24.99,
          quantity: 0,
          gender: 'male',
          productImages: [
            'https://th.bing.com/th/id/OIP.DAODAuaChdWcugRSargfvgHaJQ?r=0&rs=1&pid=ImgDetMain',
            'https://th.bing.com/th/id/OIP.DAODAuaChdWcugRSargfvgHaJQ?r=0&rs=1&pid=ImgDetMain'
          ],
          stockAlertThreshold: 3,
          createdAt: '2023-07-10T09:45:00Z'
        }
      ];

      // Initialize the products table
      function renderProductsTable(productsToRender) {
        productsTableBody.innerHTML = '';
        
        if (productsToRender.length === 0) {
          productsTableBody.innerHTML = `
            <tr>
              <td colspan="7" class="text-center py-4">No products found</td>
            </tr>
          `;
          return;
        }
        
        productsToRender.forEach(product => {
          const status = getStockStatus(product.quantity, product.stockAlertThreshold);
          const statusClass = status === 'In Stock' ? 'badge-in-stock' : 
                            status === 'Low Stock' ? 'badge-low-stock' : 'badge-out-of-stock';
          
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>
              <div class="d-flex align-items-center">
                <img src="${product.productImages[0]}" alt="${product.productName}" class="product-image me-3" />
                <div>
                  <div class="fw-semibold">${product.productName}</div>
                  <small class="text-muted">${product.productSlug}</small>
                </div>
              </div>
            </td>
            <td>${product.subcategoryName}</td>
            <td>${product.brandName}</td>
            <td>$${product.price.toFixed(2)}</td>
            <td>${product.quantity}</td>
            <td><span class="badge ${statusClass}">${status}</span></td>
            <td>
              <button class="btn btn-sm btn-outline-primary action-btn view-product" data-id="${product._id}">
                <i class="fas fa-eye"></i>
              </button>
              <button class="btn btn-sm btn-outline-secondary action-btn edit-product" data-id="${product._id}">
                <i class="fas fa-edit"></i>
              </button>
              <button class="btn btn-sm btn-outline-danger action-btn delete-product" data-id="${product._id}">
                <i class="fas fa-trash"></i>
              </button>
            </td>
          `;
          productsTableBody.appendChild(row);
        });
        
        // Add event listeners to the action buttons
        document.querySelectorAll('.view-product').forEach(btn => {
          btn.addEventListener('click', function() {
            const productId = this.getAttribute('data-id');
            viewProductDetails(productId);
          });
        });
        
        document.querySelectorAll('.edit-product').forEach(btn => {
          btn.addEventListener('click', function() {
            const productId = this.getAttribute('data-id');
            editProduct(productId);
          });
        });
        
        document.querySelectorAll('.delete-product').forEach(btn => {
          btn.addEventListener('click', function() {
            const productId = this.getAttribute('data-id');
            deleteProduct(productId);
          });
        });
      }
      
      // Get stock status based on quantity and threshold
      function getStockStatus(quantity, threshold) {
        if (quantity === 0) return 'Out of Stock';
        if (quantity <= threshold) return 'Low Stock';
        return 'In Stock';
      }
      
      // View product details
      function viewProductDetails(productId) {
        const product = products.find(p => p._id === productId);
        if (!product) return;
        
        const status = getStockStatus(product.quantity, product.stockAlertThreshold);
        const statusClass = status === 'In Stock' ? 'badge-in-stock' : 
                          status === 'Low Stock' ? 'badge-low-stock' : 'badge-out-of-stock';
        
        // Set modal content
        document.getElementById('modalProductName').textContent = product.productName;
        document.getElementById('modalProductId').textContent = product._id;
        document.getElementById('modalProductDescription').textContent = product.description;
        document.getElementById('modalProductPrice').textContent = product.price.toFixed(2);
        document.getElementById('modalProductQuantity').textContent = product.quantity;
        document.getElementById('modalProductCategory').textContent = product.subcategoryName;
        document.getElementById('modalProductBrand').textContent = product.brandName;
        document.getElementById('modalProductGender').textContent = product.gender === 'male' ? 'Male' : 'Female';
        document.getElementById('modalProductStatus').innerHTML = `<span class="badge ${statusClass}">${status}</span>`;
        document.getElementById('modalProductCreated').textContent = new Date(product.createdAt).toLocaleDateString();
        
        // Set up carousel
        const carouselInner = document.getElementById('carouselInner');
        carouselInner.innerHTML = '';
        
        product.productImages.forEach((image, index) => {
          const item = document.createElement('div');
          item.className = `carousel-item ${index === 0 ? 'active' : ''}`;
          item.innerHTML = `
            <img src="${image}" class="d-block w-100 modal-product-image" alt="${product.productName}">
          `;
          carouselInner.appendChild(item);
        });
        
        // Show modal
        const modal = new bootstrap.Modal(document.getElementById('productDetailsModal'));
        modal.show();
      }
      
      // Edit product
      function editProduct(productId) {
        // Switch to Add Product tab
        const addTab = new bootstrap.Tab(document.getElementById('add-tab'));
        addTab.show();
        
        // In a real app, you would load the product data into the form
        // For now, we'll just show an alert
        alert(`Editing product with ID: ${productId}`);
      }
      
      // Delete product
      function deleteProduct(productId) {
        if (confirm('Are you sure you want to delete this product?')) {
          // In a real app, you would make an API call to delete the product
          products = products.filter(p => p._id !== productId);
          renderProductsTable(products);
          alert('Product deleted successfully!');
        }
      }
      
      // Filter products based on search and filters
      function filterProducts() {
        const searchTerm = searchInput.value.toLowerCase();
        const categoryFilter = filterCategory.value;
        const statusFilter = filterStatus.value;
        
        let filteredProducts = products.filter(product => {
          const matchesSearch = product.productName.toLowerCase().includes(searchTerm) || 
                              product.description.toLowerCase().includes(searchTerm);
          
          const matchesCategory = categoryFilter === '' || product.subcategoryName === categoryFilter;
          
          let matchesStatus = true;
          if (statusFilter !== '') {
            const status = getStockStatus(product.quantity, product.stockAlertThreshold);
            matchesStatus = status === statusFilter;
          }
          
          return matchesSearch && matchesCategory && matchesStatus;
        });
        
        renderProductsTable(filteredProducts);
      }
      
      // Initialize the page
      renderProductsTable(products);
      
      // Set up event listeners for filtering
      searchInput.addEventListener('input', filterProducts);
      filterCategory.addEventListener('change', filterProducts);
      filterStatus.addEventListener('change', filterProducts);
      
      // Handle image upload preview
      imageUpload.addEventListener('change', function(e) {
        previewContainer.innerHTML = '';
        
        if (this.files) {
          Array.from(this.files).forEach(file => {
            if (!file.type.match('image.*')) {
              return;
            }
            
            const reader = new FileReader();
            
            reader.onload = function(e) {
              const preview = document.createElement('div');
              preview.className = 'image-preview';
              preview.innerHTML = `
                <img src="${e.target.result}" alt="Preview" />
                <button class="btn-remove" data-file="${file.name}">
                  <i class="fas fa-times"></i>
                </button>
              `;
              previewContainer.appendChild(preview);
              
              // Add remove button functionality
              preview.querySelector('.btn-remove').addEventListener('click', function() {
                preview.remove();
                // Remove the file from the input
                const newFiles = Array.from(imageUpload.files).filter(f => f.name !== this.dataset.file);
                const dataTransfer = new DataTransfer();
                newFiles.forEach(file => dataTransfer.items.add(file));
                imageUpload.files = dataTransfer.files;
              });
            }
            
            reader.readAsDataURL(file);
          });
        }
      });
      
      // Click on upload area
      uploadArea.addEventListener('click', function() {
        imageUpload.click();
      });
      
      // Drag and drop functionality
      uploadArea.addEventListener('dragover', function(e) {
        e.preventDefault();
        this.classList.add('border-primary');
        this.style.backgroundColor = 'rgba(52, 152, 219, 0.1)';
      });
      
      uploadArea.addEventListener('dragleave', function() {
        this.classList.remove('border-primary');
        this.style.backgroundColor = '';
      });
      
      uploadArea.addEventListener('drop', function(e) {
        e.preventDefault();
        this.classList.remove('border-primary');
        this.style.backgroundColor = '';
        
        if (e.dataTransfer.files.length) {
          imageUpload.files = e.dataTransfer.files;
          const event = new Event('change');
          imageUpload.dispatchEvent(event);
        }
      });
      
      // Form submission
      productForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Validate form
        if (!productForm.checkValidity()) {
          productForm.classList.add('was-validated');
          return;
        }
        
        // Prepare form data
        const formData = new FormData();
        
        // Add text fields
        formData.append('productName', document.getElementById('productName').value);
        formData.append('productSlug', document.getElementById('productSlug').value);
        formData.append('description', document.getElementById('description').value);
        formData.append('subcategoryId', document.getElementById('subcategoryId').value);
        formData.append('gender', document.querySelector('input[name="gender"]:checked').value);
        formData.append('brandId', document.getElementById('brandId').value);
        formData.append('price', document.getElementById('price').value);
        formData.append('quantity', document.getElementById('quantity').value);
        formData.append('stockAlertThreshold', document.getElementById('stockAlertThreshold').value || 0);
        
        // Add image files
        const imageFiles = imageUpload.files;
        for (let i = 0; i < imageFiles.length; i++) {
          formData.append('productImages', imageFiles[i]);
        }
        
        try {
          // In a real application, you would send this to your backend API
          // For this demo, we'll simulate the API call and add the product to our local array
          const newProduct = {
            _id: (products.length + 1).toString(),
            productName: formData.get('productName'),
            productSlug: formData.get('productSlug'),
            description: formData.get('description'),
            brandId: formData.get('brandId'),
            brandName: document.getElementById('brandId').options[document.getElementById('brandId').selectedIndex].text,
            subcategoryId: formData.get('subcategoryId'),
            subcategoryName: document.getElementById('subcategoryId').options[document.getElementById('subcategoryId').selectedIndex].text,
            price: parseFloat(formData.get('price')),
            quantity: parseInt(formData.get('quantity')),
            gender: formData.get('gender'),
            productImages: [
              'https://via.placeholder.com/300x300?text=New+Product',
              'https://via.placeholder.com/300x300?text=New+Product'
            ],
            stockAlertThreshold: parseInt(formData.get('stockAlertThreshold')) || 0,
            createdAt: new Date().toISOString()
          };
          
          // Add to our products array
          products.unshift(newProduct);
          
          // Render the updated table
          renderProductsTable(products);
          
          // Show success message and reset form
          alert('Product added successfully!');
          productForm.reset();
          previewContainer.innerHTML = '';
          
          // Switch to View Products tab
          const viewTab = new bootstrap.Tab(document.getElementById('view-tab'));
          viewTab.show();
          
        } catch (error) {
          console.error('Error adding product:', error);
          alert('Error adding product. Please try again.');
        }
      });
      
      // Auto-generate slug from product name
      document.getElementById('productName').addEventListener('input', function() {
        const slugInput = document.getElementById('productSlug');
        if (!slugInput.value) { // Only auto-generate if slug is empty
          const slug = this.value
            .toLowerCase()
            .replace(/\s+/g, '-') // Replace spaces with -
            .replace(/[^\w\-]+/g, '') // Remove all non-word chars
            .replace(/\-\-+/g, '-') // Replace multiple - with single -
            .replace(/^-+/, '') // Trim - from start of text
            .replace(/-+$/, ''); // Trim - from end of text
          slugInput.value = slug;
        }
      });
    });
  </script>
</body>
</html>